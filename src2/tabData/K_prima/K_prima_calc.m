%%  -----------------------------------------------------------------------
%   EMERGENTIA
%   13 de Diciembre de 2019
%   Creado por Sergio Esteban
%%   ----------------------------------------------------------------------
% Calculo de K_prima: where the correction for nonlinear pitching moment behavior of plain flaps is found from Figure 8.13 
% in Airplane Design Part VI and is a function of elevator deflection angle and the average elevator chord to horizontal 
% tail chord ratio aft of hinge line.
% FIGURE 6.1.1.1-40 DATCOM

function K_prima = K_prima_calc(delta_f,cf_c)

Yq = cf_c;
Xq = delta_f*180/pi;

% FIGURE 6.1.1.1-40 DATCOM
X = [0., 10., 12., 14., 16., 18., 20., 23., 27., 30., 35., 40., 50., 60.];
Y = [0.10, 0.15, 0.20, 0.25, 0.30, 0.40, 0.50];
Z = [1.000,  1.000,  0.994,  0.989,  0.970,  0.938,  0.900, 0.829, 0.755,  0.722,  0.672,  0.641,  0.596,  0.562;
     1.000,  1.000,  0.994,  0.989,  0.970,  0.937,  0.890, 0.809 0.737,  0.698,  0.650,  0.618,  0.569,  0.531;
     1.000,  1.000,  0.994,  0.989,  0.968,  0.936,  0.870, 0.783, 0.710,  0.673,  0.630,  0.595,  0.542,  0.500;
     1.000,  1.000,  0.994,  0.989,  0.965,  0.935,  0.850, 0.740, 0.677,  0.644,  0.600,  0.569,  0.518,  0.480;
     1.000,  1.000,  0.994,  0.989,  0.963,  0.905,  0.800, 0.700, 0.643,  0.610,  0.570,  0.541,  0.496,  0.461;
     1.000,  1.000,  0.993,  0.969,  0.924,  0.860,  0.750, 0.656, 0.606,  0.579,  0.540,  0.513,  0.471,  0.440;
     1.000,  1.000,  0.981,  0.943,  0.880,  0.790,  0.695, 0.625, 0.571,  0.542,  0.512,  0.490,  0.450,  0.423];
K_prima = interp2(X,Y,Z,Xq,Yq);
     